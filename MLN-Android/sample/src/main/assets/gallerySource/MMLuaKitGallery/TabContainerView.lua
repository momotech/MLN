---
--- Generated by MLN Team (http://www.immomo.com)
--- Created by MLN Team.
--- DateTime: 2019-09-05 12:05
---

local _class = {
    _name = "TabContainerView",
    _version = "1.0",
    _subViews = { },
    _subViewNames = { 'MMLuaKitGallery.HomePagerView',
                      'MMLuaKitGallery.DiscoverPagerView',
                      'MMLuaKitGallery.PlaceholderPagerView',
                      'MMLuaKitGallery.MessagePagerView',
                      'MMLuaKitGallery.MinePagerView' },
}

---å…¥å£
---@public
function _class:setup()
    self:loadExtensions()
    self:setupContainerView()
    self:setupTabar()
end

---ä¼˜å…ˆåŠ è½½å…¶ä»–è¾…åŠ©æ–‡ä»¶
---@private
function _class:loadExtensions()
    require("MMLuaKitGallery.Constant")
end

---å¸ƒå±€view
---@private
function _class:setupContainerView()
    local containerView = LinearLayout(LinearType.VERTICAL)
            :width(MeasurementType.MATCH_PARENT):height(MeasurementType.MATCH_PARENT)
    self.containerView = containerView
    window:addView(containerView)

    local contentView = View():width(MeasurementType.MATCH_PARENT):height(MeasurementType.MATCH_PARENT):setGravity(Gravity.CENTER_HORIZONTAL)
    if System:iOS() then
        contentView:marginTop(window:statusBarHeight())
    end

    self.contentView = contentView
    containerView:addView(contentView)

    --é»˜è®¤å±•ç¤ºç¬¬ä¸€é¡µ
    self:display(1)
end

---é…ç½®tabBar
---@private
function _class:setupTabar()
    local normalImages = Array()
    normalImages:add("hom")
    normalImages:add("disc")
    normalImages:add("plus")
    normalImages:add("msg")
    normalImages:add("min")

    local selectImages = Array()
    selectImages:add("hom_d")
    selectImages:add("disc_d")
    selectImages:add("plus")
    selectImages:add("msg_d")
    selectImages:add("min_d")

    self.tabbar = require('MMLuaKitGallery.TabToolBar'):new()
    self.tabbar:setupItems(normalImages, selectImages, function(idx)
        if idx == 3 then
            Toast("æ‰“å¼€ç…§ç›¸æœºğŸ“·", 1)
        else
            self:display(idx)
        end
    end)
    self.containerView:addView(self.tabbar.contentView)
end

---å±•ç¤ºViewé€»è¾‘
---@private
function _class:display(index)
    if self.prevSelectedView then
        self.prevSelectedView:rootView():removeFromSuper()
    end
    self.prevSelectedView = self._subViews[index]

    if not self.prevSelectedView then
        self.prevSelectedView = require(self._subViewNames[index]):new()
        self._subViews[index] = self.prevSelectedView
    end
    self.contentView:addView(self.prevSelectedView:rootView())
end

return _class






